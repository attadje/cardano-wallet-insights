{"mappings":"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","sources":["src/js/util.js","src/js/model.js","src/js/config.js","src/js/views/rewardsHistView.js","src/js/controller.js"],"sourcesContent":["import { TIMEOUT_SEC, BF_APIKEY, BF_PARAM_HEADER } from \"./config\";\n\nvar bf_header = new Headers();\nbf_header.append(\"project_id\", \"mainnetiSXrfNxhpPChKCnts2KX9MJ1eQ7exYgb\");\n\nconst timeout = function (s) {\n  return new Promise(function (_, reject) {\n    setTimeout(function () {\n      reject(new Error(`Request took too long! Timeout after ${s} second`));\n    }, s * 1000);\n  });\n};\n\nexport const AJAX = async function (url, uploadData = undefined) {\n  try {\n    const fetchPro = uploadData\n      ? fetch(url, {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify(uploadData),\n        })\n      : fetch(url, {\n          method: \"GET\",\n          headers: bf_header,\n        });\n\n    const res = await Promise.race([fetchPro, timeout(TIMEOUT_SEC)]);\n    const data = await res.json();\n\n    if (!res.ok) throw new Error(`${data.message} (${res.status})`);\n    return data;\n  } catch (err) {\n    throw err;\n  }\n};\n\n// 1 ADA = 1 million de lovelance\nexport const lovelanceToAda = (lovelance) => lovelance / (1000 * 1000);\n","import { BF_APIKEY, BF_NETWORK, STAKE_ADDR } from \"./config.js\";\nimport { AJAX } from \"./util.js\";\n\nexport const state = {\n  api_key: BF_APIKEY,\n  network: BF_NETWORK.mainnet,\n};\n\nexport const reward_history = async function (stake_adrr) {\n  const rewards_hist = await AJAX(\n    `${state.network}/accounts/${stake_adrr}/rewards`\n  );\n  const epochs = [];\n  const rewards = [];\n  rewards_hist.forEach(function (item) {\n    epochs.push(item.epoch);\n    rewards.push(item.amount);\n  });\n\n  return { epochs: epochs, rewards: rewards };\n\n  //cardano-mainnet.blockfrost.io/api/v0/accounts/{stake_address}/rewards\n};\n","// Blockfrost API\nexport const BF_APIKEY = \"mainnetiSXrfNxhpPChKCnts2KX9MJ1eQ7exYgb\";\nexport const BF_NETWORK = {\n  mainnet: \"https://cardano-mainnet.blockfrost.io/api/v0\",\n  testnet: \"\thttps://cardano-testnet.blockfrost.io/api/v0\",\n  ipfs: \"https://ipfs.blockfrost.io/api/v0\",\n};\n\nexport const STAKE_ADDR =\n  \"stake1uyttshgm6jtejckv48tll58hfw3fg2ffrcc4d5qvcc4yc7q9jsalf\";\n\nexport const TIMEOUT_SEC = 120;\n","class rewardsHistView {\n  _rewardsHistory;\n  _epochsHistory;\n  _parentElem = document.querySelector(\".rewardsHistory\");\n\n  _calcRewardAmount(rewards) {\n    const sumRewards = rewards.reduce((pV, cV) => pV + cV, 0);\n    return Number.parseFloat(sumRewards).toFixed(2);\n  }\n\n  _clear() {\n    this._parentElem.innerHTML = \"\";\n  }\n\n  _generateMarkup() {\n    return `<div class=\"card-header\">\n        <div class=\"row\">\n          <div class=\"col-sm-6 text-left\">\n            <h5 class=\"card-category\">Rewards History</h5>\n            <h3 class=\"card-title\">\n              <i class=\"tim-icons icon-bell-55 text-primary\"></i>\n              ${this._calcRewardAmount(this._rewardsHistory)}\n            </h3>\n          </div>\n          <div class=\"col-sm-6\">\n            <div\n              class=\"btn-group btn-group-toggle float-right\"\n              data-toggle=\"buttons\"\n            >\n              <label\n                class=\"btn btn-sm btn-primary btn-simple active\"\n                id=\"mEpochs\"\n              >\n                <input type=\"radio\" name=\"options\" checked />\n                <span\n                  class=\"d-none d-sm-block d-md-block d-lg-block d-xl-block\"\n                  >1 m</span\n                >\n                <span class=\"d-block d-sm-none\">\n                  <i class=\"tim-icons icon-single-02\"></i>\n                </span>\n              </label>\n              <label\n                class=\"btn btn-sm btn-primary btn-simple\"\n                id=\"yEpochs\"\n              >\n                <input\n                  type=\"radio\"\n                  class=\"d-none d-sm-none\"\n                  name=\"options\"\n                />\n                <span\n                  class=\"d-none d-sm-block d-md-block d-lg-block d-xl-block\"\n                  >1 a</span\n                >\n                <span class=\"d-block d-sm-none\">\n                  <i class=\"tim-icons icon-gift-2\"></i>\n                </span>\n              </label>\n              <label\n                class=\"btn btn-sm btn-primary btn-simple\"\n                id=\"allEpochs\"\n              >\n                <input type=\"radio\" class=\"d-none\" name=\"options\" />\n                <span\n                  class=\"d-none d-sm-block d-md-block d-lg-block d-xl-block\"\n                  >Max.</span\n                >\n                <span class=\"d-block d-sm-none\">\n                  <i class=\"tim-icons icon-tap-02\"></i>\n                </span>\n              </label>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body\">\n        <div class=\"chart-area\">\n          <canvas id=\"rewardsChart\"></canvas>\n        </div>\n      </div>\n    </div>\n    </div>`;\n  }\n\n  generateChart(epochs, rewards) {\n    this._rewardsHistory = rewards;\n    this.epochsHistory = epochs;\n\n    this._clear();\n    this._parentElem.insertAdjacentHTML(\"afterbegin\", this._generateMarkup());\n\n    const ctx = document.getElementById(\"rewardsChart\").getContext(\"2d\");\n    var gradientStroke = ctx.createLinearGradient(0, 230, 0, 50);\n\n    gradientStroke.addColorStop(1, \"rgba(72,72,176,0.1)\");\n    gradientStroke.addColorStop(0.4, \"rgba(72,72,176,0.0)\");\n    gradientStroke.addColorStop(0, \"rgba(119,52,169,0)\"); //purple colors\n\n    var config = {\n      type: \"line\",\n      data: {\n        labels: epochs.slice(epochs.length - 18, epochs.length),\n        datasets: [\n          {\n            label: \"Rewards\",\n            fill: true,\n            backgroundColor: gradientStroke,\n            borderColor: \"#d346b1\",\n            borderWidth: 2,\n            borderDash: [],\n            borderDashOffset: 0.0,\n            pointBackgroundColor: \"#d346b1\",\n            pointBorderColor: \"rgba(255,255,255,0)\",\n            pointHoverBackgroundColor: \"#d346b1\",\n            pointBorderWidth: 20,\n            pointHoverRadius: 4,\n            pointHoverBorderWidth: 15,\n            pointRadius: 4,\n            data: rewards.slice(rewards.length - 18, rewards.length),\n          },\n        ],\n      },\n      options: {\n        maintainAspectRatio: false,\n        legend: {\n          display: false,\n        },\n\n        tooltips: {\n          backgroundColor: \"#f5f5f5\",\n          titleFontColor: \"#333\",\n          bodyFontColor: \"#666\",\n          bodySpacing: 4,\n          xPadding: 12,\n          mode: \"nearest\",\n          intersect: 0,\n          position: \"nearest\",\n        },\n        responsive: true,\n        scales: {\n          yAxes: [\n            {\n              barPercentage: 1.6,\n              gridLines: {\n                drawBorder: false,\n                color: \"rgba(225,78,202,0.1)\",\n                zeroLineColor: \"rgba(225,78,202,0.1)\",\n              },\n              ticks: {\n                // suggestedMin: 60,\n                // suggestedMax: 125,\n                padding: 20,\n                fontColor: \"#9a9a9a\",\n                callback: function (val, index) {\n                  // Hide every 2nd tick label\n                  return index % 2 === 0 ? val : \"\";\n                },\n              },\n            },\n          ],\n\n          xAxes: [\n            {\n              barPercentage: 1.6,\n              gridLines: {\n                drawBorder: false,\n                color: \"rgba(225,78,202,0.0)\",\n                zeroLineColor: \"transparent\",\n              },\n              ticks: {\n                padding: 20,\n                fontColor: \"#9a9a9a\",\n                callback: function (val, index) {\n                  // Hide every 2nd tick label\n                  return index % 4 === 0 ? val : \"\";\n                },\n              },\n            },\n          ],\n        },\n      },\n    };\n    var myChartData = new Chart(ctx, config);\n\n    const threeMonthEpochs = (31 / 5) * 3;\n\n    if (this._rewardsHistory.length < threeMonthEpochs) {\n      const markup = ``;\n    }\n\n    document.querySelector(\"#mEpochs\").addEventListener(\"click\", function () {\n      var chart_data = rewards.slice(rewards.length - 18, rewards.length);\n      var data = myChartData.config.data;\n      data.datasets[0].data = chart_data;\n      data.labels = epochs.slice(epochs.length - 18, epochs.length);\n      myChartData.update();\n    });\n\n    document.querySelector(\"#allEpochs\").addEventListener(\"click\", function () {\n      var data = myChartData.config.data;\n      data.datasets[0].data = rewards;\n      data.labels = epochs;\n      myChartData.update();\n    });\n\n    document.querySelector(\"#yEpochs\").addEventListener(\"click\", function () {\n      var chart_data = [60, 80, 65, 130, 80, 105, 90, 130, 70, 115, 60, 130];\n      var data = myChartData.config.data;\n      data.datasets[0].data = chart_data;\n      data.labels = chart_labels;\n      myChartData.update();\n    });\n  }\n\n  _getLastEpochsRewards(nbOfEpochs) {\n    // This function return the last x number of rewards\n    return this._rewardsHistory.slice(\n      this._rewardsHistory.length - nbOfEpochs,\n      this._rewardsHistory\n    );\n  }\n\n  _addMaxButton() {}\n  _addYearButton() {}\n  _addThreeMonthButton() {}\n}\n\nexport default new rewardsHistView();\n","import { reward_history } from \"./model.js\";\nimport { STAKE_ADDR } from \"./config\";\nimport rewardsHistView from \"./views/rewardsHistView.js\";\nimport { lovelanceToAda } from \"./util.js\";\n\nconst controlRewardsHist = async function () {\n  const rewards_hist = await reward_history(STAKE_ADDR);\n\n  const adaRewards = rewards_hist.rewards.flatMap((x) => lovelanceToAda(x));\n\n  rewardsHistView.generateChart(rewards_hist.epochs, adaRewards);\n};\n\ncontrolRewardsHist();\n"],"names":["$504c2f61098a857b$var$bf_header","Headers","append","$0f1d4402dffacf5b$export$ca000e230c0caa3e","$0f1d4402dffacf5b$export$4c1cc89a0c467f4f","async","stake_adrr","rewards_hist","url","uploadData","fetchPro","fetch","method","headers","body","JSON","stringify","res","Promise","race","s","_","reject","setTimeout","Error","data","json","ok","message","status","err","$504c2f61098a857b$export$2b3ff41fecbef7c8","epochs","rewards","forEach","item","push","epoch","amount","$c88b9fe5200963f6$export$2e2bcd8739ae039","_rewardsHistory","_epochsHistory","_parentElem","document","querySelector","_calcRewardAmount","sumRewards","reduce","pV","cV","Number","parseFloat","toFixed","_clear","this","innerHTML","_generateMarkup","generateChart","epochsHistory","insertAdjacentHTML","ctx","getElementById","getContext","gradientStroke","createLinearGradient","addColorStop","config","type","labels","slice","length","datasets","label","fill","backgroundColor","borderColor","borderWidth","borderDash","borderDashOffset","pointBackgroundColor","pointBorderColor","pointHoverBackgroundColor","pointBorderWidth","pointHoverRadius","pointHoverBorderWidth","pointRadius","options","maintainAspectRatio","legend","display","tooltips","titleFontColor","bodyFontColor","bodySpacing","xPadding","mode","intersect","position","responsive","scales","yAxes","barPercentage","gridLines","drawBorder","color","zeroLineColor","ticks","padding","fontColor","callback","val","index","xAxes","myChartData","Chart","addEventListener","chart_data","update","chart_labels","_getLastEpochsRewards","nbOfEpochs","_addMaxButton","_addYearButton","_addThreeMonthButton","adaRewards","flatMap","x","$f50bd1f2915ed0f2$var$controlRewardsHist"],"version":3,"file":"index.1d3ce217.js.map"}